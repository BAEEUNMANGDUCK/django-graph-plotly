{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>미세먼지 보고서</title>
        <link rel="icon" type="image/x-icon" href="{% static "core/assets/img/favicon.ico" %}" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet" type="text/css" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
        <script
            src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous">
        </script>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="{% static "core/css/styles.css" %}" rel="stylesheet" />
        <link rel="stylesheet" href="{% static "core/css/main.css" %}">
        <script src="https://unpkg.com/htmx.org@1.6.0"></script>
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
            <a class="navbar-brand js-scroll-trigger" href="#page-top">
                <span class="d-block d-lg-none">Eunbae Kim</span>
                <span class="d-none d-lg-block"><img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="{% static "core/assets/img/mask.png" %}" alt="..." /></span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#about">미세먼지 보고서</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#experience">미세먼지 농도</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#education">측정망(소) 위치</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#skills">연도별 뉴스기사</a></li>
                </ul>
            </div>
        </nav>
        <!-- Page Content-->
        <div class="container-fluid p-0">
            <!-- About-->
            <section class="resume-section" id="about">
                <div class="resume-section-content">
                    <h1 class="mb-0">
                        미세먼지
                        <span class="text-primary">보고서</span>
                    </h1>
                    <div class="subheading mb-5">
                        Eunbae Kim · 
                        <a href="mailto:name@email.com"> rladmsqo0907@gmail.com </a>
                    </div>
                    <p>
                    &nbsp;&nbsp;&nbsp;&nbsp;미세먼지는 직경에 따라 PM-10과 PM-2.5등으로 구분하며, PM-10은 1000분의 10mm보다 작은 먼지이며, PM-2.5는 1000분의 2.5mm보다 작은 먼지로, 머리카락 직경(약 60㎛)의 1/20~1/30 크기보다 작은 입자이다.
                    미세먼지는 공기 중 고체상태와 액체상태 입자의 혼합물로 배출되며 자연적으로 생성되거나 사업장 연소, 자동차 연료 연소 등 특정 배출원으로부터 직접 발생하기도 한다. 
                    </p>
                    <p>
                    &nbsp;&nbsp;&nbsp;&nbsp;미세먼지의 성분은 발생 지역이나 계절, 기상조건, 발생원에 따라 달라질 수 있다. 
                    자연적인 미세먼지는 흙, 소금, 식물의 꽃가루 등으로 이루어져 있으며, 인위적인 미세먼지는 매연, 배기가스, 날림먼지 등이 있다. 여기서 문제되는 것은 주로 <strong>인위적인 미세먼지</strong>이다. 
                    </p>
                     <p>
                    &nbsp;&nbsp;&nbsp;&nbsp;인위적인 미세먼지의 성분은 일반적으로는 대기오염물질이 공기 중에서 반응하여 형성된 덩어리(황산염, 질산염 등)와 석탄 · 석유 등 화석연료를 태우는 과정에서 발생하는 탄소류와 검댕, 지표면 흙먼지 등에서 생기는 광물 등으로 구성된다. 
                    전국에서 측정된 미세먼지의 구성 비율을 살펴보면 <strong>황산염, 질산염이 50% 이상으로 가장 높고 탄소류와 검댕 20% 미만, 광물 5% 이상</strong>으로 이루어져 있다. 
                    </p>
                    {{ pie_chart|safe }}
                </div>
            </section>
            <hr class="m-0" />
            <!-- Experience-->
            <section class="resume-section" id="experience">
                <div class="resume-section-content">
                    <h2 class="mb-5" style="font-size:35px">미세먼지 농도</h2>
                    <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                        <div class="flex-grow-1">
                            <h4 class="mb-0">그래프 정의</h4>
                            <br>
                            <div class="subheading mb-3">2015 ~ 2022 전국인구 가중평균 미세먼지 농도 &nbsp;&&nbsp; 17개 시·도 연평균 미세먼지(PM2.5) 농도 </div>
                            <br>
                            <h4 class="mb-0">설명</h4>
                            <br>
                            <p>&nbsp;&nbsp;&nbsp;&nbsp;미세먼지(PM2.5)는 입자크기가 작아서 폐포 깊숙이 들어갈 수 있기 때문에 독성이 더 큰 것으로 알려져 있다. 특히 천식과 같은 호흡기계 질병을 악화시키고 폐기능의 저하를 초래한다.</p>
                            <p>&nbsp;&nbsp;&nbsp;&nbsp;17개 시·도의 미세먼지(PM2.5) 농도를 인구 가중평균하여 합산한 값은 2022년 <strong>17.9㎍/㎡</strong>으로, 2015년 이후 가장 낮은 수치를 보이고 있다. 이는 <strong>코로나19</strong>로 인해 대기질이 <strong>개선</strong>된 것을 반영하는 것으로, 전국 대부분 지역에서 미세먼지 농도가 2020년 보다 감소하였다. 지역별로 보면 서울, 인천, 경기, 충북, 충남, 전북 지역이 높은 편이며, 부산, 강원, 전남, 경남, 제주 지역이 15㎍/㎡ 이하로 낮은편이다.</p>
                        </div>
                        <div class="flex-shrink-0"><span class="text-primary">2015 - 2022 통계</span></div> 
                    </div> 
                    
                    {{ chart|safe }}

                    <br>
                    <form method="GET" id="search_city">
                        <select name="search_city">
                            <option value="">도시 선택</option>
                            <option value="seoul">서울</option>
                            <option value="busan">부산</option>
                            <option value="daegu">대구</option>
                            <option value="incheon">인천</option>
                            <option value="gwangju">광주</option>
                            <option value="daejeon">대전</option>
                            <option value="ulsan">울산</option>
                            <option value="sejong">세종</option>
                            <option value="gyeonggi">경기</option>
                            <option value="gangwon">강원</option>
                            <option value="chungbuk">충북</option>
                            <option value="chungnam">충남</option>
                            <option value="jeonbuk">전북</option>
                            <option value="jeonnam">전남</option>
                            <option value="gyeongbuk">경북</option>
                            <option value="gyeongnam">경남</option>
                            <option value="jeju">제주</option>
                        </select>
                        <button type="submit">검색</button>
                    </form> 
                 

                    <div id="plotly_graph">
                        {% if chart2 %}
                            {{ chart2|safe }}
                        {% endif %}
                    </div>
                </div>
            </section>
            <hr class="m-0" />
            <!-- Education-->
            <section class="resume-section" id="education">
                <div class="resume-section-content">
                    <h3 class="mb-5">측정망(소) 위치(국가배경, 도시대기)</h3>
                     <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                        {% comment %} <div class="d-flex flex-column flex-md-row justify-content-between"> {% endcomment %}
                        <div class="flex-grow-1">
                            <h4 class="mb-0">국가배경 농도 측정망(소)</h4>
                            <br>
                            <p>국가의 배경농도를 파악하고 외국으로의 오염물질 유입, 유출상태 등을 파악을 위한 측정소이다.</p>
                            <br>
                            <div>측정항목: SO2, CO, NO2, O3, PM-10, PM-2.5 등</div>
                            <br>
                                {{ map1 | safe }}
                        </div>
                        <div class="flex-shrink-0"><span class="text-primary">11개 (7개 시·군)</span></div>
                    </div>
                    <hr>
                
                    <div class="d-flex flex-column flex-md-row justify-content-between">
                        <div class="flex-grow-1">
                            <h4 class="mb-0">도시대기 측정망(소)</h4>
                            <br>
                            <p>도심(거주)지역의 평균대기질 농도를 파악하기 위한 측정소이다.</p>
                            <br>
                            <div>측정항목: SO2, CO, NO2, O3, PM-10, PM-2.5 등</div>
                            <br>
                                {{ map2 | safe }}
                        </div>
                        <div class="flex-shrink-0"><span class="text-primary">532개 (누락데이터 포함 총 161개 시·군)</span></div>
                    </div>
                    <hr>
                    <div class="d-flex flex-column flex-md-row justify-content-between">
                        <div class="flex-grow-1">
                            <h5 class="mb-0">지도 누락 측정망(소) 테이블(27개)</h5>
                            <br>
                            {{ nurak | safe }}
                        </div>
                    
                    </div>
                </div>
            </section>
            <hr class="m-0" />
            <!-- Skills-->
            <section class="resume-section" id="skills" style="display:block;">
                <div class="resume-section-content">
                    <h3 class="mb-5">미세먼지 관련 뉴스기사 수</h3>
                    <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                        <div class="flex-grow-1">
                            <h4 class="mb-0">그래프 정의</h4>
                            <br>
                            <div class="subheading mb-3">2015 ~ 2023 연도별 미세먼지 관련 뉴스기사 수 그래프</div>
                            <br>
                            <h4 class="mb-0">설명</h4>
                            <br>
                            <p>&nbsp;&nbsp;&nbsp;&nbsp;2015년부터 미세먼지 관련 뉴스 수가 매년 지속적으로 증가하다 2020년 큰 폭으로 감소하였다. 이는 <strong>코로나19로 인한 사회·경제적 활동의 감소, 정부 정책에 따른 국내 배출량 감축, 양호한 기상상황</strong> 등이 복합적으로 작용하여 미세먼지가 크게 감소했기 때문인 것으로 보인다.</p>
                            <p>&nbsp;&nbsp;&nbsp;&nbsp;하지만 다음 해, 국내의 <strong>코로나 규제의 완화, 외부 요인(해외 공장 가동 재개)</strong>에 대한 언론의 우려가 심화되어 2023년 현재 이미 2019년의 수치를 뛰어넘은 것을 볼 수 있다.</p>
                        </div>
                        <div class="flex-shrink-0"><span class="text-primary">2015 - 2023(1~10월) 통계 </span></div> 
                    </div> 
                    {{ num_news_line|safe }}
                </div>
            </section>
            <hr class="m-0" />
        </div>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="{% static "core/js/scripts.js" %}"></script>
        {% comment %} <script type="text/javascript">
            $(document).ready(function(){
                $("select[name=search_city]").change(function(){
                $("#search_city").submit();
                });
            });
        </script> {% endcomment %}
        {% comment %} <script type="text/javascript">
            $(document).ready(function(){
                $('#search_city').submit(function(event){
                    event.preventDefault();
                    var city = $('select[name=search_city]').val();
                    $.ajax({
                        url: '/index/',
                        type: 'GET',
                        data: {search_city: city},
                        success: function(response){
                        }
                    })
                })
            })
            
        </script> {% endcomment %}
        <script type="text/javascript">
            $(document).ready(function(){
                $('#search_city').submit(function(event){
                    event.preventDefault();
                    var city = $('select[name=search_city]').val();
                    
                    $.ajax({
                        url: '{% url "update_chart" %}',
                        type: 'GET',
                        data: {search_city: city},
                        success: function(data){
                            $("#plotly_graph").html(data);
                        }
                    })
                })
            })
        </script>
    </body>
</html>
